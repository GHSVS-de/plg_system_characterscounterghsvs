(function(e,t){"use strict";"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?module.exports=t():e.VCountdown=t()})(this,function(){"use strict";var e=function(t){if(!(this&&this instanceof e))return new e(t);if(t||(t={}),!t.target)throw"Provide a target to count characters";var a=document.querySelectorAll(t.target);a&&a.length&&(t.target=a[0],this.target=t.target,this.maxChars=t.maxChars||140,this.chopText=t.chopText||!1,this.removeMaxlength=t.removeMaxlength||!1,this.charsTypedLabel=this.sanitizeHtml(Joomla.JText._(t.charsTypedLabel)),this.countdown())};return e.prototype={hasClass:function(e,t){return new RegExp("(\\s|^)"+t+"(\\s|$)").test(e.className)},addClass:function(e,t){this.hasClass(e,t)||(e.className+=(e.className?" ":"")+t)},removeClass:function(e,t){this.hasClass(e,t)&&(e.className=e.className.replace(new RegExp("(\\s|^)"+t+"(\\s|$)")," ").replace(/^\s+|\s+$/g,""))},createEls:function(e,t){var a,s=document.createElement(e);for(a in t)t.hasOwnProperty(a)&&(s[a]=t[a]);return s},insertAfter:function(e,t){e.parentNode.insertBefore(t,e.nextSibling)},update:function(){var e=this.target,t=e.value.length,a=this.maxChars-t;a>10?(this.removeClass(e.nextElementSibling,"warn"),this.removeClass(e.nextElementSibling,"overflow")):a<0?this.addClass(e.nextElementSibling,"overflow"):(this.removeClass(e.nextElementSibling,"overflow"),this.addClass(e.nextElementSibling,"warn"));var s=this.charsTypedLabel.replace("{currentCount}",`<span class=chars-typed>${t}</span>`).replace("{maxChars}",`<span class=chars-max>${this.maxChars}</span>`).replace("{remaining}",`<span class=chars-remain>${a}</span>`);e.nextElementSibling.innerHTML=s},deleteMaxlength:function(){this.target.removeAttribute("maxlength")},setMaxChars:function(){this.target.setAttribute("maxlength",this.maxChars)},charsLen:function(){var e=this.createEls("span",{className:"chars-length"});e.innerHTML=this.maxChars,this.insertAfter(this.target,e),this.update()},countdown:function(){this.removeMaxlength&&this.deleteMaxlength(),this.chopText&&this.setMaxChars(),this.charsLen(),this.target.addEventListener("keyup",this.update.bind(this),!1)},sanitizeHtml:function(e,t){const a=/^aria-[\w-]*$/i,s=/^data-[\w-]*$/i,n={"*":["class","dir","id","lang","role",a,s],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[],button:["type"],input:["accept","alt","autocomplete","autofocus","capture","checked","dirname","disabled","height","list","max","maxlength","min","minlength","multiple","type","name","pattern","placeholder","readonly","required","size","src","step","value","width","inputmode"],select:["name"],textarea:["name"],option:["value","selected"]};if(!e.length)return e;if(t&&"function"==typeof t)return t(e);const r=new window.DOMParser,i=r.parseFromString(e,"text/html"),l=Object.keys(n),o=[].concat(...i.body.querySelectorAll("*"));for(let e=0,t=o.length;e<t;e++){const t=o[e],a=t.nodeName.toLowerCase();if(!l.includes(a)){t.remove();continue}const s=[].concat(...t.attributes),r=[].concat(n["*"]||[],n[a]||[]);s.forEach(e=>{allowedAttribute(e,r)||t.removeAttribute(e.nodeName)})}return i.body.innerHTML}},e});